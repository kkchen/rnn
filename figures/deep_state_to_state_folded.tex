\begin{tikzpicture}[node distance=7mm, auto]
    \node (state) [state] {$\s_t$};
    \node (state 1) [state, right=5mm of state] {$\z_t$};
    \node (input) [state, below=of state] {$\x_t$};
    \node (output) [state, above=of state] {$\y_t$};
    \node (loss) [function, above=of output] {$L$};
    \node (data) [data, above=of loss] {$\ETA_t$};

    \node (skip 0) [inner sep=0.5mm, above=1mm of state] {};
    \node (skip 00) [coordinate, left=8mm of skip 0] {};
    \node (skip 01) [coordinate, right=19mm of skip 0] {};

    \node (skip 1) [inner sep=0.5mm, below=2.5mm of state] {};
    \node (skip 10) [coordinate, left=8mm of skip 1] {};
    \node (skip 11) [coordinate, right=6mm of skip 1] {};

    % Arrows.
    \draw [path] (input) --
    node [label, pos=0.25, right, xshift=-0.5mm] {$\f$}
    (state);
    \draw [path] (state) -- node [label, pos=0.6, right] {$\h$} (output);
    \draw [path] (output) -- (loss);
    \draw [path] (data) -- (loss);

    \draw [path] (state.15) --
    node [label, pos=0.4, yshift=-0.5mm] {$\g$}
    (state 1.165);
    \draw [thick] (state 1.15) -|
    node [label, right, pos=0.7, xshift=-0.5mm] {$\f$}
    (skip 01) -- (skip 0);
    \draw [path] (skip 0) -- (skip 00) |- (state.165);

    \uncover<2->{
        \draw [thick] (state.345) -|
        node [label, pos=0.9, xshift=-0.5mm] {$\f$}
        (skip 11) -- (skip 1);
        \draw [path] (skip 1) -- (skip 10) |- (state.190);
    }
\end{tikzpicture}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../rnn"
%%% End:
